<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Music Bot Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        h1 {
            font-size: 2rem;
            color: #fff;
        }

        .back-link {
            color: #4ecdc4;
            text-decoration: none;
            font-size: 0.9rem;
        }

        .back-link:hover {
            text-decoration: underline;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: #4ecdc4;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #aaa;
            margin-top: 5px;
        }

        .section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .section h2 {
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: #4ecdc4;
        }

        .list-item {
            display: flex;
            align-items: center;
            padding: 12px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            margin-bottom: 8px;
        }

        .list-item:last-child {
            margin-bottom: 0;
        }

        .rank {
            width: 30px;
            height: 30px;
            background: #4ecdc4;
            color: #1a1a2e;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
            font-size: 0.9rem;
        }

        .rank.gold {
            background: linear-gradient(135deg, #f5af19, #f12711);
        }

        .rank.silver {
            background: linear-gradient(135deg, #bdc3c7, #2c3e50);
        }

        .rank.bronze {
            background: linear-gradient(135deg, #b8860b, #8b4513);
        }

        .item-info {
            flex: 1;
        }

        .item-name {
            font-weight: 500;
            margin-bottom: 3px;
        }

        .item-detail {
            font-size: 0.8rem;
            color: #888;
        }

        .item-count {
            font-size: 1.2rem;
            font-weight: bold;
            color: #4ecdc4;
        }

        .two-columns {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
        }

        .recent-song {
            display: flex;
            align-items: center;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            margin-bottom: 8px;
        }

        .recent-song:last-child {
            margin-bottom: 0;
        }

        .thumbnail {
            width: 60px;
            height: 45px;
            border-radius: 4px;
            margin-right: 12px;
            object-fit: cover;
        }

        .song-info {
            flex: 1;
            min-width: 0;
        }

        .song-title {
            font-size: 0.9rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            margin-bottom: 3px;
        }

        .song-meta {
            font-size: 0.75rem;
            color: #888;
        }

        .played-badge {
            font-size: 0.7rem;
            padding: 3px 8px;
            border-radius: 10px;
            background: #27ae60;
            color: #fff;
        }

        .pending-badge {
            font-size: 0.7rem;
            padding: 3px 8px;
            border-radius: 10px;
            background: #f39c12;
            color: #fff;
        }

        .empty-message {
            text-align: center;
            color: #666;
            padding: 20px;
        }

        @media (max-width: 768px) {
            .two-columns {
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .stat-value {
                font-size: 1.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Music Bot Dashboard</h1>
            <a href="/" class="back-link">← 플레이어로 돌아가기</a>
        </header>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value" th:text="${stats.totalSongs}">0</div>
                <div class="stat-label">전체 곡</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" th:text="${stats.playedSongs}">0</div>
                <div class="stat-label">재생된 곡</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" th:text="${stats.pendingSongs}">0</div>
                <div class="stat-label">대기 중</div>
            </div>
        </div>

        <div class="two-columns">
            <div class="section">
                <h2>Top Contributors</h2>
                <div th:if="${#lists.isEmpty(stats.topContributors)}" class="empty-message">
                    아직 데이터가 없습니다
                </div>
                <div th:each="user, iterStat : ${stats.topContributors}" class="list-item">
                    <div class="rank"
                         th:classappend="${iterStat.index == 0} ? 'gold' : (${iterStat.index == 1} ? 'silver' : (${iterStat.index == 2} ? 'bronze' : ''))"
                         th:text="${iterStat.index + 1}">1</div>
                    <div class="item-info">
                        <div class="item-name" th:text="${user.username}">Username</div>
                        <div class="item-detail">
                            추가: <span th:text="${user.addedCount}">0</span>곡 /
                            재생됨: <span th:text="${user.playedCount}">0</span>곡
                        </div>
                    </div>
                    <div class="item-count" th:text="${user.addedCount}">0</div>
                </div>
            </div>

            <div class="section">
                <h2>Most Added Songs</h2>
                <div th:if="${#lists.isEmpty(stats.mostPlayedSongs)}" class="empty-message">
                    아직 데이터가 없습니다
                </div>
                <div th:each="song, iterStat : ${stats.mostPlayedSongs}" class="list-item">
                    <div class="rank"
                         th:classappend="${iterStat.index == 0} ? 'gold' : (${iterStat.index == 1} ? 'silver' : (${iterStat.index == 2} ? 'bronze' : ''))"
                         th:text="${iterStat.index + 1}">1</div>
                    <div class="item-info">
                        <div class="item-name" th:text="${song.title}">Song Title</div>
                        <div class="item-detail" th:text="${song.videoId}">videoId</div>
                    </div>
                    <div class="item-count" th:text="${song.count}">0</div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>Recently Added</h2>
            <div th:if="${#lists.isEmpty(stats.recentSongs)}" class="empty-message">
                아직 데이터가 없습니다
            </div>
            <div th:each="song : ${stats.recentSongs}" class="recent-song">
                <img class="thumbnail"
                     th:src="${song.thumbnailUrl}"
                     alt="thumbnail"
                     onerror="this.src='https://via.placeholder.com/60x45?text=No+Image'">
                <div class="song-info">
                    <div class="song-title" th:text="${song.title}">Song Title</div>
                    <div class="song-meta">
                        <span th:text="${song.addedBy}">user</span>
                    </div>
                </div>
                <span th:if="${song.played}" class="played-badge">재생됨</span>
                <span th:unless="${song.played}" class="pending-badge">대기중</span>
            </div>
        </div>
    </div>
</body>
</html>
